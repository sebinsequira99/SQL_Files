USE MAPFACQB_STAGE
GO

/******************************************Add column ImportFlag ************************************************/
IF NOT EXISTS(SELECT * FROM sys.columns WHERE Name = N'OldUser_ID' AND Object_ID = Object_ID(N'MAPSystemData'))    
BEGIN
ALTER TABLE MAPSystemData
ADD OldUser_ID INT
END
GO
/***************************************************************************************************************/
INSERT INTO MAPSystemData
(
User_Id
,Agency
,ContactAIRSId
,AP1ContactId
,AP1Fname
,AP1MName
,AP1LName
,AP1DOB
,AP1Gender
,AP1SSN
,AP1BirthCity
,AP1BirthState
,AP1BirthCountry
,AP1Salutation
,AP1RaceId
,AP1Race
,AP1EthnicityId
,AP1Ethnicity
,AP1WorkPhone
,AP1CellPhone
,AP1EmailId
,AP1Email
,AP2ContactId
,AP2Fname
,AP2MName
,AP2LName
,AP2DOB
,AP2Gender
,AP2SSN
,AP2BirthCity
,AP2BirthState
,AP2BirthCountry
,AP2Salutation
,AP2RaceId
,AP2Race
,AP2EthnicityId
,AP2Ethnicity
,AP2WorkPhone
,AP2CellPhone
,AP2EmailId
,AP2Email
,AddressId
,Add1
,Add2
,City
,State
,Zip
,Country
,HomePhone
,Languages
,Child1ContactId
,Child1FName
,Child1LName
,Child1Gender
,Child2ContactId
,Child2FName
,Child2LName
,Child2Gender
,Child3ContactId
,Child3FName
,Child3LName
,Child3Gender
,Child4ContactId
,Child4FName
,Child4LName
,Child4Gender
,Child5ContactId
,Child5FName
,Child5LName
,Child5Gender
,AgencyCaseId
,CaseId
,CaseWorkerContactId
,CaseWorkerId
,CaseStartDate
,ProgramId
,SubProgramId
,Rel1ContactId
,Rel1FName
,Rel1LName
,Rel1Gender
,Rel1DOB
,Rel1Relationship
,Rel2ContactId
,Rel2FName
,Rel2LName
,Rel2Gender
,Rel2DOB
,Rel2Relationship
,Rel3ContactId
,Rel3FName
,Rel3LName
,Rel3Gender
,Rel3DOB
,Rel3Relationship
,Rel4ContactId
,Rel4FName
,Rel4LName
,Rel4Gender
,Rel4DOB
,Rel4Relationship
,Rel5ContactId
,Rel5FName
,Rel5LName
,Rel5Gender
,Rel5DOB
,Rel5Relationship
,Rel6ContactId
,Rel6FName
,Rel6LName
,Rel6Gender
,Rel6DOB
,Rel6Relationship
,Rel7ContactId
,Rel7FName
,Rel7LName
,Rel7Gender
,Rel7DOB
,Rel7Relationship
,Rel8ContactId
,Rel8FName
,Rel8LName
,Rel8Gender
,Rel8DOB
,Rel8Relationship
,Rel9ContactId
,Rel9FName
,Rel9LName
,Rel9Gender
,Rel9DOB
,Rel9Relationship
,Rel10ContactId
,Rel10FName
,Rel10LName
,Rel10Gender
,Rel10DOB
,Rel10Relationship
,Ref1ContactId
,Ref1Fname
,Ref1LName
,Ref1Relationship
,Ref1AddressId
,Ref1Add1
,Ref1Add2
,Ref1City
,Ref1State
,Ref1Zip
,Ref2ContactId
,Ref2Fname
,Ref2LName
,Ref2Relationship
,Ref2AddressId
,Ref2Add1
,Ref2Add2
,Ref2City
,Ref2State
,Ref2Zip
,Ref3ContactId
,Ref3Fname
,Ref3LName
,Ref3Relationship
,Ref3AddressId
,Ref3Add1
,Ref3Add2
,Ref3City
,Ref3State
,Ref3Zip
,Ref4ContactId
,Ref4Fname
,Ref4LName
,Ref4Relationship
,Ref4AddressId
,Ref4Add1
,Ref4Add2
,Ref4City
,Ref4State
,Ref4Zip
,Ref5ContactId
,Ref5Fname
,Ref5LName
,Ref5Relationship
,Ref5AddressId
,Ref5Add1
,Ref5Add2
,Ref5City
,Ref5State
,Ref5Zip
,Emp1ContactId
,Emp1Fname
,Emp1LName
,Emp1Relationship
,Emp1AddressId
,Emp1Add1
,Emp1Add2
,Emp1City
,Emp1State
,Emp1Zip
,Emp2ContactId
,Emp2Fname
,Emp2LName
,Emp2Relationship
,Emp2AddressId
,Emp2Add1
,Emp2Add2
,Emp2City
,Emp2State
,Emp2Zip
,AP1ContactEducationID
,AP1Degree
,AP1Institution
,AP1DegreeYear
,AP2ContactEducationID
,AP2Degree
,AP2Institution
,AP2DegreeYear
,County
,AP1ReligionId
,AP1Religion
,AP2ReligionId
,AP2Religion
,Emp1Salary
,Emp2Salary
,AP1ContactMarraigeId
,AP1Spouse
,AP1MarriageStatus
,AP2ContactMarraigeId
,AP2Spouse
,AP2MarriageStatus
,Ref6ContactId
,Ref6Fname
,Ref6LName
,Ref6Relationship
,Ref6AddressId
,Ref6Add1
,Ref6Add2
,Ref6City
,Ref6State
,Ref6Zip
,Ref7ContactId
,Ref7Fname
,Ref7LName
,Ref7Relationship
,Ref7AddressId
,Ref7Add1
,Ref7Add2
,Ref7City
,Ref7State
,Ref7Zip
,Ref8ContactId
,Ref8Fname
,Ref8LName
,Ref8Relationship
,Ref1EmailId
,Ref1Email
,Ref2EmailId
,Ref2Email
,Ref3EmailId
,Ref3Email
,Ref4EmailId
,Ref4Email
,Ref5EmailId
,Ref5Email
,Ref6EmailId
,Ref6Email
,Ref7EmailId
,Ref7Email
,Ref8EmailId
,Ref8Email
,Rel1EmailId
,Rel1Email
,Rel2EmailId
,Rel2Email
,Rel3EmailId
,Rel3Email
,Rel4EmailId
,Rel4Email
,Rel5EmailId
,Rel5Email
,Rel6EmailId
,Rel6Email
,Rel7EmailId
,Rel7Email
,Rel8EmailId
,Rel8Email
,Rel9EmailId
,Rel9Email
,Rel10EmailId
,Rel10Email
,Rel1HomePhone
,Rel2HomePhone
,Rel3HomePhone
,Rel4HomePhone
,Rel5HomePhone
,Rel6HomePhone
,Rel7HomePhone
,Rel8HomePhone
,Rel9HomePhone
,Rel10HomePhone
,Rel1AddressId
,Rel1Add1
,Rel1Add2
,Rel1City
,Rel1State
,Rel1Zip
,Rel2AddressId
,Rel2Add1
,Rel2Add2
,Rel2City
,Rel2State
,Rel2Zip
,Rel3AddressId
,Rel3Add1
,Rel3Add2
,Rel3City
,Rel3State
,Rel3Zip
,Rel4AddressId
,Rel4Add1
,Rel4Add2
,Rel4City
,Rel4State
,Rel4Zip
,Rel5AddressId
,Rel5Add1
,Rel5Add2
,Rel5City
,Rel5State
,Rel5Zip
,Rel6AddressId
,Rel6Add1
,Rel6Add2
,Rel6City
,Rel6State
,Rel6Zip
,Rel7AddressId
,Rel8AddressId
,Rel8Add1
,Rel8Add2
,Rel8City
,Rel8State
,Rel8Zip
,Rel9AddressId
,Rel9Add1
,Rel9Add2
,Rel9City
,Rel9State
,Rel9Zip
,Rel10AddressId
,Rel10Add1
,Rel10Add2
,Rel10City
,Rel10State
,Rel10Zip
,Rel7Add1
,Rel7Add2
,Rel7City
,Rel7State
,Rel7Zip
,Rel1PhoneId
,Rel2PhoneId
,Rel3PhoneId
,Rel4PhoneId
,Rel5PhoneId
,Rel6PhoneId
,Rel7PhoneId
,Rel8PhoneId
,Rel9PhoneId
,Rel10PhoneId
,Ref9EmailId
,Ref9Email
,Ref10EmailId
,Ref10Email
,Ref9ContactId
,Ref9Fname
,Ref9LName
,Ref9Relationship
,Ref9AddressId
,Ref9Add1
,Ref9Add2
,Ref9City
,Ref9State
,Ref9Zip
,Ref10ContactId
,Ref10Fname
,Ref10LName
,Ref10Relationship
,Ref10AddressId
,Ref10Add1
,Ref10Add2
,Ref10City
,Ref10State
,Ref10Zip
,AP1MarraigeDate
,AP1TerminationDate
,AP1TermReason
,AP1ContactMarraigeId2
,AP1Spouse2
,AP1MarriageStatus2
,AP1MarraigeDate2
,AP1TerminationDate2
,AP1TermReason2
,AP2MarraigeDate
,AP2TerminationDate
,AP2TermReason
,AP2ContactMarraigeId2
,AP2Spouse2
,AP2MarriageStatus2
,AP2MarraigeDate2
,AP2TerminationDate2
,AP2TermReason2
,AP1Race2
,AP1RaceId2
,AP1Race3
,AP1RaceId3
,AP2Race2
,AP2RaceId2
,AP2Race3
,AP2RaceId3
,ConnId
,OldUser_ID
)
SELECT
User_Id+100000
,Agency
,ContactAIRSId+100000

,CASE
	WHEN AP1ContactId>19389 THEN AP1ContactId+100000
	ELSE AP1ContactId
END
,AP1Fname
,AP1MName
,AP1LName
,AP1DOB
,AP1Gender
,AP1SSN
,AP1BirthCity
,AP1BirthState
,AP1BirthCountry
,AP1Salutation
,AP1RaceId+100000
,AP1Race
,AP1EthnicityId+100000
,AP1Ethnicity
,AP1WorkPhone
,AP1CellPhone
,AP1EmailId+100000
,AP1Email
,CASE
	WHEN AP2ContactId>19389 THEN AP2ContactId+100000
	ELSE AP2ContactId
END
,AP2Fname
,AP2MName
,AP2LName
,AP2DOB
,AP2Gender
,AP2SSN
,AP2BirthCity
,AP2BirthState
,AP2BirthCountry
,AP2Salutation
,AP2RaceId+100000
,AP2Race
,AP2EthnicityId+100000
,AP2Ethnicity
,AP2WorkPhone
,AP2CellPhone
,AP2EmailId+100000
,AP2Email
,AddressId+100000
,Add1
,Add2
,City
,State
,Zip
,Country
,HomePhone
,Languages
,Child1ContactId+100000
,Child1FName
,Child1LName
,Child1Gender
,Child2ContactId+100000
,Child2FName
,Child2LName
,Child2Gender
,Child3ContactId+100000
,Child3FName
,Child3LName
,Child3Gender
,Child4ContactId+100000
,Child4FName
,Child4LName
,Child4Gender
,Child5ContactId+100000
,Child5FName
,Child5LName
,Child5Gender
,AgencyCaseId
,CaseId
,CaseWorkerContactId+100000
,CASE
	WHEN CaseWorkerId>0 THEN CaseWorkerId+100000
	ELSE CaseWorkerId
END
,CaseStartDate
,ProgramId
,SubProgramId
,Rel1ContactId+100000
,Rel1FName
,Rel1LName
,Rel1Gender
,Rel1DOB
,Rel1Relationship
,Rel2ContactId+100000
,Rel2FName
,Rel2LName
,Rel2Gender
,Rel2DOB
,Rel2Relationship
,Rel3ContactId+100000
,Rel3FName
,Rel3LName
,Rel3Gender
,Rel3DOB
,Rel3Relationship
,Rel4ContactId+100000
,Rel4FName
,Rel4LName
,Rel4Gender
,Rel4DOB
,Rel4Relationship
,Rel5ContactId+100000
,Rel5FName
,Rel5LName
,Rel5Gender
,Rel5DOB
,Rel5Relationship
,Rel6ContactId+100000
,Rel6FName
,Rel6LName
,Rel6Gender
,Rel6DOB
,Rel6Relationship
,Rel7ContactId+100000
,Rel7FName
,Rel7LName
,Rel7Gender
,Rel7DOB
,Rel7Relationship
,Rel8ContactId+100000
,Rel8FName
,Rel8LName
,Rel8Gender
,Rel8DOB
,Rel8Relationship
,Rel9ContactId+100000
,Rel9FName
,Rel9LName
,Rel9Gender
,Rel9DOB
,Rel9Relationship
,Rel10ContactId+100000
,Rel10FName
,Rel10LName
,Rel10Gender
,Rel10DOB
,Rel10Relationship
,Ref1ContactId+100000
,Ref1Fname
,Ref1LName
,Ref1Relationship
,Ref1AddressId+100000
,Ref1Add1
,Ref1Add2
,Ref1City
,Ref1State
,Ref1Zip
,Ref2ContactId+100000
,Ref2Fname
,Ref2LName
,Ref2Relationship
,Ref2AddressId+100000
,Ref2Add1
,Ref2Add2
,Ref2City
,Ref2State
,Ref2Zip
,Ref3ContactId+100000
,Ref3Fname
,Ref3LName
,Ref3Relationship
,Ref3AddressId+100000
,Ref3Add1
,Ref3Add2
,Ref3City
,Ref3State
,Ref3Zip
,Ref4ContactId+100000
,Ref4Fname
,Ref4LName
,Ref4Relationship
,Ref4AddressId+100000
,Ref4Add1
,Ref4Add2
,Ref4City
,Ref4State
,Ref4Zip
,Ref5ContactId+100000
,Ref5Fname
,Ref5LName
,Ref5Relationship
,Ref5AddressId+100000
,Ref5Add1
,Ref5Add2
,Ref5City
,Ref5State
,Ref5Zip
,Emp1ContactId+100000
,Emp1Fname
,Emp1LName
,Emp1Relationship
,Emp1AddressId+100000
,Emp1Add1
,Emp1Add2
,Emp1City
,Emp1State
,Emp1Zip
,Emp2ContactId+100000
,Emp2Fname
,Emp2LName
,Emp2Relationship
,Emp2AddressId+100000
,Emp2Add1
,Emp2Add2
,Emp2City
,Emp2State
,Emp2Zip
,AP1ContactEducationID+100000
,AP1Degree
,AP1Institution
,AP1DegreeYear
,AP2ContactEducationID+100000
,AP2Degree
,AP2Institution
,AP2DegreeYear
,County
,AP1ReligionId+100000
,AP1Religion
,AP2ReligionId+100000
,AP2Religion
,Emp1Salary
,Emp2Salary
,AP1ContactMarraigeId+100000
,AP1Spouse
,AP1MarriageStatus
,AP2ContactMarraigeId+100000
,AP2Spouse
,AP2MarriageStatus
,Ref6ContactId+100000
,Ref6Fname
,Ref6LName
,Ref6Relationship
,Ref6AddressId+100000
,Ref6Add1
,Ref6Add2
,Ref6City
,Ref6State
,Ref6Zip
,Ref7ContactId+100000
,Ref7Fname
,Ref7LName
,Ref7Relationship
,Ref7AddressId+100000
,Ref7Add1
,Ref7Add2
,Ref7City
,Ref7State
,Ref7Zip
,Ref8ContactId+100000
,Ref8Fname
,Ref8LName
,Ref8Relationship
,Ref1EmailId+100000
,Ref1Email
,Ref2EmailId+100000
,Ref2Email
,Ref3EmailId+100000
,Ref3Email
,Ref4EmailId+100000
,Ref4Email
,Ref5EmailId+100000
,Ref5Email
,Ref6EmailId+100000
,Ref6Email
,Ref7EmailId+100000
,Ref7Email
,Ref8EmailId+100000
,Ref8Email
,Rel1EmailId+100000
,Rel1Email
,Rel2EmailId+100000
,Rel2Email
,Rel3EmailId+100000
,Rel3Email
,Rel4EmailId+100000
,Rel4Email
,Rel5EmailId+100000
,Rel5Email
,Rel6EmailId+100000
,Rel6Email
,Rel7EmailId+100000
,Rel7Email
,Rel8EmailId+100000
,Rel8Email
,Rel9EmailId+100000
,Rel9Email
,Rel10EmailId+100000
,Rel10Email
,Rel1HomePhone
,Rel2HomePhone
,Rel3HomePhone
,Rel4HomePhone
,Rel5HomePhone
,Rel6HomePhone
,Rel7HomePhone
,Rel8HomePhone
,Rel9HomePhone
,Rel10HomePhone
,Rel1AddressId+100000
,Rel1Add1
,Rel1Add2
,Rel1City
,Rel1State
,Rel1Zip
,Rel2AddressId+100000
,Rel2Add1
,Rel2Add2
,Rel2City
,Rel2State
,Rel2Zip
,Rel3AddressId+100000
,Rel3Add1
,Rel3Add2
,Rel3City
,Rel3State
,Rel3Zip
,Rel4AddressId+100000
,Rel4Add1
,Rel4Add2
,Rel4City
,Rel4State
,Rel4Zip
,Rel5AddressId+100000
,Rel5Add1
,Rel5Add2
,Rel5City
,Rel5State
,Rel5Zip
,Rel6AddressId+100000
,Rel6Add1
,Rel6Add2
,Rel6City
,Rel6State
,Rel6Zip
,Rel7AddressId+100000
,Rel8AddressId+100000
,Rel8Add1
,Rel8Add2
,Rel8City
,Rel8State
,Rel8Zip
,Rel9AddressId+100000
,Rel9Add1
,Rel9Add2
,Rel9City
,Rel9State
,Rel9Zip
,Rel10AddressId+100000
,Rel10Add1
,Rel10Add2
,Rel10City
,Rel10State
,Rel10Zip
,Rel7Add1
,Rel7Add2
,Rel7City
,Rel7State
,Rel7Zip
,Rel1PhoneId+100000
,Rel2PhoneId+100000
,Rel3PhoneId+100000
,Rel4PhoneId+100000
,Rel5PhoneId+100000
,Rel6PhoneId+100000
,Rel7PhoneId+100000
,Rel8PhoneId+100000
,Rel9PhoneId+100000
,Rel10PhoneId+100000
,Ref9EmailId+100000
,Ref9Email
,Ref10EmailId+100000
,Ref10Email
,Ref9ContactId+100000
,Ref9Fname
,Ref9LName
,Ref9Relationship
,Ref9AddressId+100000
,Ref9Add1
,Ref9Add2
,Ref9City
,Ref9State
,Ref9Zip
,Ref10ContactId+100000
,Ref10Fname
,Ref10LName
,Ref10Relationship
,Ref10AddressId+100000
,Ref10Add1
,Ref10Add2
,Ref10City
,Ref10State
,Ref10Zip
,AP1MarraigeDate
,AP1TerminationDate
,AP1TermReason
,AP1ContactMarraigeId2+100000
,AP1Spouse2
,AP1MarriageStatus2
,AP1MarraigeDate2
,AP1TerminationDate2
,AP1TermReason2
,AP2MarraigeDate
,AP2TerminationDate
,AP2TermReason
,AP2ContactMarraigeId2+100000
,AP2Spouse2
,AP2MarriageStatus2
,AP2MarraigeDate2
,AP2TerminationDate2
,AP2TermReason2
,AP1Race2
,AP1RaceId2+100000
,AP1Race3
,AP1RaceId3+100000
,AP2Race2
,AP2RaceId2+100000
,AP2Race3
,AP2RaceId3+100000
,((ConnId*-1)+100000)*-1
,User_ID
FROM MAPFAC.DBO.MAPSystemData
WHERE user_id>=13433 AND Agency = 17

--51